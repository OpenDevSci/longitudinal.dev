{"parsed":{"_path":"/tutorials/exploratory-data-analysis/exploratory_diagnostic-plots","_dir":"exploratory-data-analysis","_draft":false,"_partial":false,"_locale":"","title":"Diagnostic Plots for Longitudinal Data Models","description":"","body":{"type":"root","children":[{"type":"element","tag":"h3","props":{"id":"introduction"},"children":[{"type":"text","value":"Introduction"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Diagnostic plots are essential tools for evaluating the assumptions of statistical models. In longitudinal data analysis, these plots help assess model fit, check for outliers, and ensure that assumptions like normality and homoscedasticity are met. This tutorial will guide you through creating and interpreting key diagnostic plots."}]},{"type":"element","tag":"h3","props":{"id":"residual-vs-fitted-plot"},"children":[{"type":"text","value":"Residual vs Fitted Plot"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This plot helps assess whether residuals are randomly distributed. If the model is correctly specified, residuals should show no systematic pattern."}]},{"type":"element","tag":"pre","props":{"className":"language-r shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","code":"# Residual vs Fitted plot\nresiduals <- resid(model)\nfitted_values <- fitted(model)\nplot(fitted_values, residuals, xlab = \"Fitted Values\", ylab = \"Residuals\")\nabline(h = 0, col = \"red\")\n","language":"r","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Residual vs Fitted plot\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"residuals <- resid(model)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"fitted_values <- fitted(model)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"plot(fitted_values, residuals, xlab = \"Fitted Values\", ylab = \"Residuals\")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"abline(h = 0, col = \"red\")\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"normal-q-q-plot"},"children":[{"type":"text","value":"Normal Q-Q Plot"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A Q-Q plot checks if the residuals are normally distributed. If the points follow the 45-degree line, then the residuals are approximately normal."}]},{"type":"element","tag":"pre","props":{"className":"language-r shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","code":"# Q-Q plot\nqqnorm(residuals)\nqqline(residuals, col = \"red\")\n","language":"r","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Q-Q plot\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"qqnorm(residuals)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"qqline(residuals, col = \"red\")\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"scale-location-plot"},"children":[{"type":"text","value":"Scale-Location Plot"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This plot helps check the assumption of homoscedasticity, which means that the variance of residuals should remain constant across fitted values."}]},{"type":"element","tag":"pre","props":{"className":"language-r shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","code":"# Scale-Location plot\nsqrt_residuals <- sqrt(abs(residuals))\nplot(fitted_values, sqrt_residuals, xlab = \"Fitted Values\", ylab = \"Sqrt(|Residuals|)\")\n","language":"r","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Scale-Location plot\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"sqrt_residuals <- sqrt(abs(residuals))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"plot(fitted_values, sqrt_residuals, xlab = \"Fitted Values\", ylab = \"Sqrt(|Residuals|)\")\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"cooks-distance"},"children":[{"type":"text","value":"Cook's Distance"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Cook's distance measures the influence of individual data points on the model. Large values indicate influential observations that may be distorting the model."}]},{"type":"element","tag":"pre","props":{"className":"language-r shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","code":"# Cook's Distance plot\ncooks_distance <- cooks.distance(model)\nplot(cooks_distance, type = \"h\", ylab = \"Cook's Distance\")\nabline(h = 4/(nrow(longitudinal_data) - length(coef(model))), col = \"red\")\n","language":"r","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Cook's Distance plot\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"cooks_distance <- cooks.distance(model)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"plot(cooks_distance, type = \"h\", ylab = \"Cook's Distance\")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"abline(h = 4/(nrow(longitudinal_data) - length(coef(model))), col = \"red\")\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"conclusion"},"children":[{"type":"text","value":"Conclusion"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Diagnostic plots are invaluable for verifying model assumptions and identifying areas where the model may be improved. By using these plots, you can ensure that your longitudinal data models are both reliable and robust. Stay curious and keep experimenting with these toolsâ€”they'll help sharpen your analytic skills!"}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"introduction","depth":3,"text":"Introduction"},{"id":"residual-vs-fitted-plot","depth":3,"text":"Residual vs Fitted Plot"},{"id":"normal-q-q-plot","depth":3,"text":"Normal Q-Q Plot"},{"id":"scale-location-plot","depth":3,"text":"Scale-Location Plot"},{"id":"cooks-distance","depth":3,"text":"Cook's Distance"},{"id":"conclusion","depth":3,"text":"Conclusion"}]}},"_type":"markdown","_id":"content:2.tutorials:3.exploratory-data-analysis:Exploratory_diagnostic-plots.qmd","_source":"content","_file":"2.tutorials/3.exploratory-data-analysis/Exploratory_diagnostic-plots.qmd","_extension":"qmd"},"hash":"xL5c5U5yjq"}