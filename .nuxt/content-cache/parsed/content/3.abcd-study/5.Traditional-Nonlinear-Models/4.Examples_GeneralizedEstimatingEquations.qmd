{"parsed":{"_path":"/abcd-study/traditional-nonlinear-models/examples_generalizedestimatingequations","_dir":"traditional-nonlinear-models","_draft":false,"_partial":false,"_locale":"","title":"Generalized Estimating Equations","description":"","author":"Biostatistics Working Group","body":{"type":"root","children":[{"type":"element","tag":"pre","props":{"className":"language-r shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","code":"#| echo: FALSE # The content of this code block will not be shown when rendered\n#| output: FALSE # Output from this code block will not be shown when rendered\n\n# This code configures knitr code chunk options\n\nknitr::opts_chunk$set(echo = T, message=F, warning=F, error=F, output=T,\n                      comment=NA, cache=T, code_folding=T,\n                      R.options=list(width=220, digits = 3),\n                      fig.align='center', \n                      out.width='75%', fig.asp=.75)\n","filename":"codeBlock.r","language":"r","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"#| echo: FALSE # The content of this code block will not be shown when rendered\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"#| output: FALSE # Output from this code block will not be shown when rendered\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# This code configures knitr code chunk options\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"knitr::opts_chunk$set(echo = T, message=F, warning=F, error=F, output=T,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                      comment=NA, cache=T, code_folding=T,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                      R.options=list(width=220, digits = 3),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                      fig.align='center', \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                      out.width='75%', fig.asp=.75)\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-r shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","code":"#| echo: FALSE # The content of this code block will not be shown when rendered\n#| output: FALSE # Output from this code block will not be shown when rendered\n#| cache: FALSE\n\n# This code loads the data to be used for the example\n\nlibrary(tidyverse)\n\n# Set the data path\ndata_path <- \"/Users/shawes/ABCD/data/rds/abcd_5.0_rds/core-rds-5.0/non-imaging_excluding_nt_5.0.rds\"\n\n# Read the data\ndf <- readRDS(data_path)\n\n# Create and mutate the dataframe\ndf_long <- df %>%\n    select(src_subject_id, eventname, anthroheightcalc) %>%\n    filter(eventname %in% c(\"baseline_year_1_arm_1\", \"1_year_follow_up_y_arm_1\", \"2_year_follow_up_y_arm_1\", \"3_year_follow_up_y_arm_1\")) %>%\n    drop_na(anthroheightcalc) %>%\n    arrange(src_subject_id, eventname) %>%\n    mutate(\n        src_subject_id = factor(src_subject_id),\n        eventname = factor(eventname, levels = c(\"baseline_year_1_arm_1\", \"1_year_follow_up_y_arm_1\", \"2_year_follow_up_y_arm_1\", \"3_year_follow_up_y_arm_1\"), labels = c(\"Baseline\", \"Year_1\", \"Year_2\", \"Year_3\")),\n        anthroheightcalc = round(as.numeric(anthroheightcalc), 2)\n    ) %>%\n    rename(\n        id = src_subject_id,\n        event = eventname,\n        height = anthroheightcalc\n    )\n\ndf_long <- df_long %>%\n    group_by(id) %>%\n    filter(all(c(\"Baseline\", \"Year_1\", \"Year_2\", \"Year_3\") %in% event)) %>%\n    ungroup()\n\n","filename":"codeBlock.r","language":"r","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"#| echo: FALSE # The content of this code block will not be shown when rendered\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"#| output: FALSE # Output from this code block will not be shown when rendered\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"#| cache: FALSE\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# This code loads the data to be used for the example\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"library(tidyverse)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Set the data path\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"data_path <- \"/Users/shawes/ABCD/data/rds/abcd_5.0_rds/core-rds-5.0/non-imaging_excluding_nt_5.0.rds\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Read the data\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"df <- readRDS(data_path)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Create and mutate the dataframe\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"df_long <- df %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    select(src_subject_id, eventname, anthroheightcalc) %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    filter(eventname %in% c(\"baseline_year_1_arm_1\", \"1_year_follow_up_y_arm_1\", \"2_year_follow_up_y_arm_1\", \"3_year_follow_up_y_arm_1\")) %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    drop_na(anthroheightcalc) %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    arrange(src_subject_id, eventname) %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    mutate(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        src_subject_id = factor(src_subject_id),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        eventname = factor(eventname, levels = c(\"baseline_year_1_arm_1\", \"1_year_follow_up_y_arm_1\", \"2_year_follow_up_y_arm_1\", \"3_year_follow_up_y_arm_1\"), labels = c(\"Baseline\", \"Year_1\", \"Year_2\", \"Year_3\")),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        anthroheightcalc = round(as.numeric(anthroheightcalc), 2)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    ) %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    rename(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        id = src_subject_id,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        event = eventname,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        height = anthroheightcalc\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    )\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"df_long <- df_long %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    group_by(id) %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    filter(all(c(\"Baseline\", \"Year_1\", \"Year_2\", \"Year_3\") %in% event)) %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    ungroup()\n"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"overview"},"children":[{"type":"text","value":"Overview"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Generalized Estimating Equations (GEE) are an extension of generalized linear models used for analyzing longitudinal and other correlated response data. GEEs provide a method for estimating the parameters of a generalized linear model with and are particularly useful when dealing with repeated measurements or clustered data, offering robust standard errors that account for within-subject correlations."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This example will examine height across 3 annual measurement occasions in a sample of youth taking part in the ABCD Study. The primary aim is to characterize the average growth pattern in height over time at the population level. GEEs will be employed to estimate the mean height at each time point, accounting for the correlation of repeated measurements within individuals. This approach will help us understand how height changes over time while providing robust estimates that account for the inherent correlation in the repeated measures data."}]},{"type":"element","tag":"h2","props":{"id":"preliminary-setup"},"children":[{"type":"text","value":"Preliminary Setup"}]},{"type":"element","tag":"h3","props":{"id":"load-r-libraries"},"children":[{"type":"text","value":"Load R libraries"}]},{"type":"element","tag":"pre","props":{"className":"language-r shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","code":"\nlibrary(tidyverse)    # Collection of R packages for data science\nlibrary(rstatix)      # Pipe-friendly framework for basic statistical tests\nlibrary(geepack)      # Generalized Estimating Equations (GEE) analysis\nlibrary(gtsummary) # Publication-ready tables\n\n","filename":"codeBlock.r","language":"r","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"library(tidyverse)    # Collection of R packages for data science\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"library(rstatix)      # Pipe-friendly framework for basic statistical tests\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"library(geepack)      # Generalized Estimating Equations (GEE) analysis\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"library(gtsummary) # Publication-ready tables\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"descriptives"},"children":[{"type":"text","value":"Descriptives"}]},{"type":"element","tag":"pre","props":{"className":"language-r shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","code":"\ndescriptives_table <- df_long %>%\n    select(event, height) %>%\n    mutate(event = factor(event)) %>%\n    tbl_summary(\n        by = event,\n        missing = \"no\",\n        label = list(height ~ \"Height\"),\n        statistic = list(all_continuous() ~ \"{mean} ({sd})\", all_categorical() ~ \"{p}%\"),\n    ) %>%\n    modify_header(all_stat_cols() ~ \"**{level}**<br>N = {n}\") %>%\n    bold_labels() %>%\n    italicize_levels() %>%\n    modify_spanning_header(all_stat_cols() ~ \"**Assessment Wave**\")\ntheme_gtsummary_compact()\n\ndescriptives_table\n\n","filename":"codeBlock.r","language":"r","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"descriptives_table <- df_long %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    select(event, height) %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    mutate(event = factor(event)) %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    tbl_summary(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        by = event,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        missing = \"no\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        label = list(height ~ \"Height\"),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        statistic = list(all_continuous() ~ \"{mean} ({sd})\", all_categorical() ~ \"{p}%\"),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    ) %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    modify_header(all_stat_cols() ~ \"**{level}**<br>N = {n}\") %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    bold_labels() %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    italicize_levels() %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    modify_spanning_header(all_stat_cols() ~ \"**Assessment Wave**\")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"theme_gtsummary_compact()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"descriptives_table\n"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"results"},"children":[{"type":"text","value":"Results"}]},{"type":"element","tag":"h3","props":{"id":"compute-generalized-estimating-equations-analysis"},"children":[{"type":"text","value":"Compute Generalized Estimating Equations Analysis"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This code fits a Generalized Estimating Equations (GEE) model to predict 'Height' across 3 annual visits, accounting for within-subject correlation of repeated measurements. The model output is provided below, along with a summary of results. This approach uses GEEs to estimate the population-averaged effects, providing robust standard errors and accommodating the correlation structure of the repeated height measurements."}]},{"type":"element","tag":"pre","props":{"className":"language-r shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","code":"\nmodel <- geeglm(height ~ event, data = df_long, id = id, family = gaussian(), corstr = \"exchangeable\")\n\nsummary(model)\n","filename":"codeBlock.r","language":"r","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"model <- geeglm(height ~ event, data = df_long, id = id, family = gaussian(), corstr = \"exchangeable\")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"summary(model)\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"These results indicate a significant increase in height across the years, with an increase of approximately 2.41 inches in Year 1 and 5.20 inches by Year 2 compared to the baseline, as evidenced by the fixed effects estimates. The exchangeable correlation structure suggests a consistent correlation between repeated measurements within individuals, with an estimated correlation parameter (alpha) of 0.681. The significant Wald statistics and p-values (< 2e-16) for each year indicate strong evidence of height changes over time in the population."}]},{"type":"element","tag":"h3","props":{"id":"model-plots"},"children":[{"type":"text","value":"Model Plots"}]},{"type":"element","tag":"pre","props":{"className":"language-r shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","code":"\n# Fit the GEE model\nmodel <- geeglm(height ~ event, data = df_long, id = id, family = gaussian(), corstr = \"exchangeable\")\n\n# Extract the predicted means and standard errors\npredicted_values <- data.frame(\n  event = unique(df_long$event),\n  mean_height = predict(model, newdata = data.frame(event = unique(df_long$event)), type = \"response\"),\n  se = sqrt(diag(vcov(model)))\n)\n\n# Calculate confidence intervals\npredicted_values <- predicted_values %>%\n  mutate(\n    ci_lower = mean_height - 1.96 * se,\n    ci_upper = mean_height + 1.96 * se\n  )\n\n# Generate the plot\nggplot(predicted_values, aes(x = event, y = mean_height)) +\n  geom_line(color = \"blue\", linewidth = 1) +\n  geom_point(color = \"blue\", size = 3) +\n  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2, color = \"blue\") +\n  labs(\n    title = \"Mean Height Across Time Points with Confidence Intervals (GEE)\",\n    x = \"Time Point\",\n    y = \"Mean Height (inches)\"\n  ) +\n  theme_minimal()\n\n","filename":"codeBlock.r","language":"r","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Fit the GEE model\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"model <- geeglm(height ~ event, data = df_long, id = id, family = gaussian(), corstr = \"exchangeable\")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Extract the predicted means and standard errors\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"predicted_values <- data.frame(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"  event = unique(df_long$event),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"  mean_height = predict(model, newdata = data.frame(event = unique(df_long$event)), type = \"response\"),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"  se = sqrt(diag(vcov(model)))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Calculate confidence intervals\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"predicted_values <- predicted_values %>%\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"  mutate(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    ci_lower = mean_height - 1.96 * se,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    ci_upper = mean_height + 1.96 * se\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"  )\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Generate the plot\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"ggplot(predicted_values, aes(x = event, y = mean_height)) +\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"  geom_line(color = \"blue\", linewidth = 1) +\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"  geom_point(color = \"blue\", size = 3) +\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2, color = \"blue\") +\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"  labs(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    title = \"Mean Height Across Time Points with Confidence Intervals (GEE)\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    x = \"Time Point\",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    y = \"Mean Height (inches)\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"  ) +\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"  theme_minimal()\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This plot illustrates the mean height of participants across three annual measurement occasions, as estimated by the generalized estimating equations (GEE) model. The blue line and points represent the estimated mean height at each time point, while the error bars show the 95% confidence intervals around these estimates."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The plot reveals a clear increasing trend in height over time, with mean height values rising at each subsequent measurement occasion. The confidence intervals provide a sense of the variability and precision of these mean estimates, indicating that the observed increase in height is statistically significant. This visualization highlights the overall growth pattern in the sample, capturing the population-averaged trends effectively."}]},{"type":"element","tag":"h2","props":{"id":"wrapping-up"},"children":[{"type":"text","value":"Wrapping Up"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The marginal model analysis using Generalized Estimating Equations (GEE) revealed a significant increase in children's height measured over 3 annual assessments. The mean intercept value showed an average initial height of 55.12 inches. The fixed effects estimates indicated year-to-year growth increments of approximately 2.41 inches in Year 1 and 5.20 inches by Year 2 compared to the baseline."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The GEE framework employed in this example captured the population-averaged trends while accounting for the correlation of repeated measurements within individuals. The exchangeable correlation structure suggested that measurements were consistently correlated within individuals, with an estimated correlation parameter (alpha) of 0.681. The significant Wald statistics and p-values (< 2e-16) provided strong evidence of height changes over time."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The marginal model approach is particularly useful in developmental studies as it estimates common parameters across all individuals, offering a clear understanding of population-level trends in longitudinal data. This method is valuable for examining average growth patterns while accounting for the correlation in repeated measurements, providing insights into the overall changes in height over time."}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"overview","depth":2,"text":"Overview"},{"id":"preliminary-setup","depth":2,"text":"Preliminary Setup","children":[{"id":"load-r-libraries","depth":3,"text":"Load R libraries"},{"id":"descriptives","depth":3,"text":"Descriptives"}]},{"id":"results","depth":2,"text":"Results","children":[{"id":"compute-generalized-estimating-equations-analysis","depth":3,"text":"Compute Generalized Estimating Equations Analysis"},{"id":"model-plots","depth":3,"text":"Model Plots"}]},{"id":"wrapping-up","depth":2,"text":"Wrapping Up"}]}},"_type":"markdown","_id":"content:3.abcd-study:5.Traditional-Nonlinear-Models:4.Examples_GeneralizedEstimatingEquations.qmd","_source":"content","_file":"3.abcd-study/5.Traditional-Nonlinear-Models/4.Examples_GeneralizedEstimatingEquations.qmd","_extension":"qmd"},"hash":"FxGO6VgHXj"}